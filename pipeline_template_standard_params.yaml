#
# Copyright (c) 2025 by Delphix. All rights reserved.
#

# LinkedServiceParameters count for each pipeline template
# Key: pipeline name
# Value: LinkedServiceParameter name and its expected count

pipeline_linked_service_params:
  Snowflake_discovery:
    LS_DATABASE: 2
    LS_WAREHOUSE: 2
    LS_ROLE: 2

  Snowflake_mask:
    LS_DATABASE: 11
    LS_WAREHOUSE: 11
    LS_ROLE: 11

  AzureSQL_discovery:
    LS_DATABASE: 2

  AzureSQL_mask:
    LS_DATABASE: 13

  AzureSQL_MI_discovery:
    LS_DATABASE: 2

  AzureSQL_MI_mask:
    LS_DATABASE: 13

  Azure_Postgres_discovery:
    LS_DATABASE: 2

  Azure_Postgres_mask:
    LS_DATABASE: 11

# Linked Service Naming Conventions
linked_service_conventions:
  # Rules 1 & 2: Mandatory services that must be present in all pipelines
  mandatory_services:
    - name: "Metadata Datastore"
      support_type: "AzureSqlDatabase"
    - name: "ProdDCSForAzureService"
      support_type: "RestService"
  
  # Rule 3: Pipelines that do in-place masking (Source without Sink is valid)
  # Note: In-place masking pipelines should contain "in_place" in their name
  in_place_masking_pipelines:
    - "dcsazure_Dataverse_to_Dataverse_in_place_mask_pl"
  
  # Rules 4 & 5: Regex patterns for validation
  naming_patterns:
    rest_service: "^[A-Z][a-zA-Z0-9]+$"  # Rule 4: CamelCase, no underscores
    non_rest_service: "^[A-Z][a-zA-Z0-9]+_(Source|Sink|Staging)$"  # Rule 5
  
  # Support type to technology name mapping (for Rules 3 & 5 validation)
  # Rule 3: Used to identify Source/Sink linked services
  # Rule 5: Used to verify the technology prefix matches the support type
  support_type_to_technology:
    AzureBlobFS: "AzureDataLakeStorage"
    AzureSqlDatabase: "AzureSqlDatabase"
    AzureSqlMI: "AzureSqlMI"
    SnowflakeV2: "Snowflake"
    AzureDatabricksDeltaLake: "AzureDatabricksDeltaLake"
    AzureBlobStorage: "BlobStorage"
    CommonDataServiceForApps: "Dataverse"
    AzurePostgreSql: "AzurePostgreSql"

